{"version":3,"file":"defer.js","sources":["defer.ts"],"sourcesContent":["// SPDX-FileCopyrightText: 2023 Open Pioneer project (https://github.com/open-pioneer)\n// SPDX-License-Identifier: Apache-2.0\nexport interface DeferredExecution {\n    /**\n     * Re-schedule execution of `func` (if it was not already executed).\n     * Returns true on success, false otherwise.\n     */\n    reschedule(): boolean;\n\n    /**\n     * Cancels the pending execution (if it is still pending).\n     */\n    cancel(): void;\n}\n\n/**\n * Calls `func` at a slightly later time.\n *\n * The returned object can be used to re-schedule or cancel the execution of `func`.\n * However, `func` will be executed at most once.\n */\nexport function defer(func: () => void): DeferredExecution {\n    let executed = false;\n    let timeout: ReturnType<typeof setTimeout> | undefined = setTimeout(() => {\n        executed = true;\n        timeout = undefined;\n        func();\n    });\n    return {\n        reschedule() {\n            // Do nothing: if not executed, the timeout is still pending\n            // and it will run in the future.\n            return !executed;\n        },\n        cancel() {\n            if (timeout) {\n                clearTimeout(timeout);\n            }\n        }\n    };\n}\n"],"names":[],"mappings":"AAqBO,SAAS,MAAM,IAAA,EAAqC;AACvD,EAAA,IAAI,QAAA,GAAW,KAAA;AACf,EAAA,IAAI,OAAA,GAAqD,WAAW,MAAM;AACtE,IAAA,QAAA,GAAW,IAAA;AACX,IAAA,OAAA,GAAU,MAAA;AACV,IAAA,IAAA,EAAK;AAAA,GACR,CAAA;AACD,EAAA,OAAO;AAAA,IACH,UAAA,GAAa;AAGT,MAAA,OAAO,CAAC,QAAA;AAAA,KACZ;AAAA,IACA,MAAA,GAAS;AACL,MAAA,IAAI,OAAA,EAAS;AACT,QAAA,YAAA,CAAa,OAAO,CAAA;AAAA;AACxB;AACJ,GACJ;AACJ;;;;"}