{"version":3,"file":"CustomComponents.js","sources":["CustomComponents.tsx"],"sourcesContent":["// SPDX-FileCopyrightText: 2023 Open Pioneer project (https://github.com/open-pioneer)\n// SPDX-License-Identifier: Apache-2.0\nimport { SearchIcon } from \"@chakra-ui/icons\";\nimport { CloseButton, chakra } from \"@open-pioneer/chakra-integration\";\nimport {\n    ClearIndicatorProps,\n    IndicatorsContainerProps,\n    InputProps,\n    MenuProps,\n    NoticeProps,\n    OptionProps,\n    Props as SelectProps,\n    SingleValueProps,\n    ValueContainerProps,\n    chakraComponents\n} from \"chakra-react-select\";\nimport classNames from \"classnames\";\nimport { useIntl } from \"open-pioneer:react-hooks\";\nimport { UIEvent } from \"react\";\nimport { SearchGroupOption, SearchOption } from \"./Search\";\n\nexport function MenuComp(props: MenuProps<SearchOption, false, SearchGroupOption>) {\n    const hasInput = props.selectProps.inputValue.length > 0;\n    const menuProps: typeof props = {\n        ...props,\n        className: classNames(props.className, {\n            \"search-invisible\": !hasInput\n        })\n    };\n\n    return <chakraComponents.Menu {...menuProps}>{props.children}</chakraComponents.Menu>;\n}\n\nexport function NoOptionsMessage(props: NoticeProps<SearchOption, false, SearchGroupOption>) {\n    const intl = useIntl();\n    const noMessageText = intl.formatMessage({ id: \"noOptionsText\" });\n\n    return (\n        <chakraComponents.NoOptionsMessage {...props}>\n            <chakra.span className=\"search-no-match\">{noMessageText}</chakra.span>\n        </chakraComponents.NoOptionsMessage>\n    );\n}\n\nexport function LoadingMessage(props: NoticeProps<SearchOption, false, SearchGroupOption>) {\n    const intl = useIntl();\n    const loadingText = intl.formatMessage({ id: \"loadingText\" });\n\n    return (\n        <chakraComponents.LoadingMessage {...props}>\n            <chakra.span className=\"search-loading-text\">{loadingText}</chakra.span>\n        </chakraComponents.LoadingMessage>\n    );\n}\n\nexport function ValueContainer({\n    children,\n    ...props\n}: ValueContainerProps<SearchOption, false, SearchGroupOption>) {\n    const containerProps: typeof props = {\n        ...props,\n        className: classNames(props.className, \"search-value-container\")\n    };\n    return (\n        <chakraComponents.ValueContainer {...containerProps}>\n            {!!children && <SearchIcon style={{ position: \"absolute\", left: 8 }}></SearchIcon>}\n            {children}\n        </chakraComponents.ValueContainer>\n    );\n}\n\nexport function Input(props: InputProps<SearchOption, false, SearchGroupOption>) {\n    const inputProps: typeof props = {\n        ...props,\n        isHidden: false\n    };\n    return <chakraComponents.Input {...inputProps} />;\n}\n\nexport function SingleValue(_props: SingleValueProps<SearchOption, false, SearchGroupOption>) {\n    // Never render anything (we use the text input to show the selected result)\n    return null;\n}\n\nexport function IndicatorsContainer(\n    props: IndicatorsContainerProps<SearchOption, false, SearchGroupOption>\n) {\n    return (\n        <chakraComponents.IndicatorsContainer {...props}>\n            {props.children}\n            {!props.selectProps.isLoading && props.selectProps.inputValue && (\n                <CustomClearIndicator\n                    selectProps={props.selectProps}\n                    clearValue={props.clearValue}\n                />\n            )}\n        </chakraComponents.IndicatorsContainer>\n    );\n}\n\nfunction CustomClearIndicator(props: {\n    clearValue(): void;\n    selectProps: SelectProps<SearchOption, false, SearchGroupOption>;\n}) {\n    const intl = useIntl();\n    const clearButtonLabel = intl.formatMessage({\n        id: \"ariaLabel.clearButton\"\n    });\n    const clickHandler = (e: UIEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n        props.clearValue();\n    };\n\n    return (\n        <CloseButton\n            role=\"button\"\n            size=\"md\"\n            mr={1}\n            aria-label={clearButtonLabel}\n            onClick={clickHandler}\n            // needed for correct touch handling; select control would otherwise preventDefault()\n            onTouchEnd={clickHandler}\n            // Stop select component from opening the menu.\n            // It will otherwise flash briefly because of a mouse down listener in the select.\n            onMouseDown={(e) => e.preventDefault()}\n        />\n    );\n}\n\nexport function ClearIndicator(\n    _props: ClearIndicatorProps<SearchOption, false, SearchGroupOption>\n) {\n    // Never render anything; we use our own clear indicator\n    return null;\n}\n\nexport function HighlightOption(props: OptionProps<SearchOption, false, SearchGroupOption>) {\n    const userInput = props.selectProps.inputValue;\n    const label = props.data.label;\n    const optionProps: typeof props = {\n        ...props,\n        className: classNames(props.className, \"search-option\")\n    };\n    return (\n        <chakraComponents.Option {...optionProps}>\n            <chakra.div className=\"search-option-label\">\n                {userInput.trim().length > 0 ? getHighlightedLabel(label, userInput) : label}\n            </chakra.div>\n        </chakraComponents.Option>\n    );\n}\n\nfunction getHighlightedLabel(label: string, userInput: string) {\n    const matchIndex = label.toLowerCase().indexOf(userInput.toLowerCase());\n    if (matchIndex >= 0) {\n        return (\n            <>\n                {label.substring(0, matchIndex)}\n                <chakra.span key=\"highlighted\" className=\"search-highlighted-match\">\n                    {label.substring(matchIndex, matchIndex + userInput.length)}\n                </chakra.span>\n                {label.substring(matchIndex + userInput.length)}\n            </>\n        );\n    }\n    return label;\n}\n"],"names":[],"mappings":"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"}